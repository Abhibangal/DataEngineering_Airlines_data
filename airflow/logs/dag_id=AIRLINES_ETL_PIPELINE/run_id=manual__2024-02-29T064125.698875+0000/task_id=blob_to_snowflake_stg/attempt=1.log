[2024-02-29T06:41:33.999+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: AIRLINES_ETL_PIPELINE.blob_to_snowflake_stg manual__2024-02-29T06:41:25.698875+00:00 [queued]>
[2024-02-29T06:41:34.017+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: AIRLINES_ETL_PIPELINE.blob_to_snowflake_stg manual__2024-02-29T06:41:25.698875+00:00 [queued]>
[2024-02-29T06:41:34.018+0000] {taskinstance.py:2193} INFO - Starting attempt 1 of 1
[2024-02-29T06:41:34.104+0000] {taskinstance.py:2214} INFO - Executing <Task(SnowflakeOperator): blob_to_snowflake_stg> on 2024-02-29 06:41:25.698875+00:00
[2024-02-29T06:41:34.148+0000] {standard_task_runner.py:60} INFO - Started process 120 to run task
[2024-02-29T06:41:34.152+0000] {standard_task_runner.py:87} INFO - Running: ['airflow', 'tasks', 'run', 'AIRLINES_ETL_PIPELINE', 'blob_to_snowflake_stg', 'manual__2024-02-29T06:41:25.698875+00:00', '--job-id', '100', '--raw', '--subdir', 'DAGS_FOLDER/AIRLINES_DATA_ETL_DAG.py', '--cfg-path', '/tmp/tmp6hjfnsp7']
[2024-02-29T06:41:34.155+0000] {standard_task_runner.py:88} INFO - Job 100: Subtask blob_to_snowflake_stg
[2024-02-29T06:41:34.328+0000] {task_command.py:423} INFO - Running <TaskInstance: AIRLINES_ETL_PIPELINE.blob_to_snowflake_stg manual__2024-02-29T06:41:25.698875+00:00 [running]> on host 586f09520b0e
[2024-02-29T06:41:36.074+0000] {taskinstance.py:2510} INFO - Exporting env vars: AIRFLOW_CTX_DAG_EMAIL='abhijit.bangal92@gmail.com' AIRFLOW_CTX_DAG_OWNER='airflow' AIRFLOW_CTX_DAG_ID='AIRLINES_ETL_PIPELINE' AIRFLOW_CTX_TASK_ID='blob_to_snowflake_stg' AIRFLOW_CTX_EXECUTION_DATE='2024-02-29T06:41:25.698875+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2024-02-29T06:41:25.698875+00:00'
[2024-02-29T06:41:36.076+0000] {sql.py:276} INFO - Executing: Truncat table TEST_ANALYTICS.AIRLINES.airlines_stg;
copy into TEST_ANALYTICS.AIRLINES.airlines_stg from 
                                @TEST_ANALYTICS.AIRLINES.TEST_AIRLINES_BLOB_STG/Airlines_Data.csv.gz
                                            file_format = 'TEST_ANALYTICS.AIRLINES.AIRLINES_CSV_FORMAT',
                                            ON_ERROR = ABORT_STATEMENT ,
                                            force = FALSE;
                                            
[2024-02-29T06:41:36.098+0000] {base.py:83} INFO - Using connection ID 'snowflake_conn_id' for task execution.
[2024-02-29T06:41:36.466+0000] {base.py:83} INFO - Using connection ID 'snowflake_conn_id' for task execution.
[2024-02-29T06:41:36.467+0000] {connection.py:386} INFO - Snowflake Connector for Python Version: 3.7.1, Python Version: 3.11.8, Platform: Linux-5.15.133.1-microsoft-standard-WSL2-x86_64-with-glibc2.36
[2024-02-29T06:41:36.468+0000] {connection.py:1211} INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
[2024-02-29T06:41:37.239+0000] {cursor.py:1032} INFO - query: [ALTER SESSION SET autocommit=False]
[2024-02-29T06:41:37.345+0000] {cursor.py:1045} INFO - query execution done
[2024-02-29T06:41:37.347+0000] {cursor.py:1205} INFO - Number of results in first chunk: 1
[2024-02-29T06:41:37.347+0000] {sql.py:457} INFO - Running statement: Truncat table TEST_ANALYTICS.AIRLINES.airlines_stg;, parameters: None
[2024-02-29T06:41:37.348+0000] {cursor.py:1032} INFO - query: [Truncat table TEST_ANALYTICS.AIRLINES.airlines_stg;]
[2024-02-29T06:41:37.432+0000] {cursor.py:1045} INFO - query execution done
[2024-02-29T06:41:37.435+0000] {connection.py:734} INFO - closed
[2024-02-29T06:41:37.471+0000] {connection.py:740} INFO - No async queries seem to be running, deleting session
[2024-02-29T06:41:37.520+0000] {taskinstance.py:2728} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/providers/common/sql/operators/sql.py", line 282, in execute
    output = hook.run(
             ^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/providers/snowflake/hooks/snowflake.py", line 390, in run
    self._run_command(cur, sql_statement, parameters)  # type: ignore[attr-defined]
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/providers/common/sql/hooks/sql.py", line 462, in _run_command
    cur.execute(sql_statement)
  File "/home/airflow/.local/lib/python3.11/site-packages/snowflake/connector/cursor.py", line 1136, in execute
    Error.errorhandler_wrapper(self.connection, self, error_class, errvalue)
  File "/home/airflow/.local/lib/python3.11/site-packages/snowflake/connector/errors.py", line 290, in errorhandler_wrapper
    handed_over = Error.hand_to_other_handler(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/snowflake/connector/errors.py", line 345, in hand_to_other_handler
    cursor.errorhandler(connection, cursor, error_class, error_value)
  File "/home/airflow/.local/lib/python3.11/site-packages/snowflake/connector/errors.py", line 221, in default_errorhandler
    raise error_class(
snowflake.connector.errors.ProgrammingError: 001003 (42000): 01b2ab51-0001-18d1-0000-000393fa7179: SQL compilation error:
syntax error line 1 at position 0 unexpected 'Truncat'.
[2024-02-29T06:41:37.535+0000] {taskinstance.py:1149} INFO - Marking task as FAILED. dag_id=AIRLINES_ETL_PIPELINE, task_id=blob_to_snowflake_stg, execution_date=20240229T064125, start_date=20240229T064134, end_date=20240229T064137
[2024-02-29T06:41:37.564+0000] {logging_mixin.py:188} WARNING - /home/airflow/.local/lib/python3.11/site-packages/airflow/utils/email.py:154 RemovedInAirflow3Warning: Fetching SMTP credentials from configuration variables will be deprecated in a future release. Please set credentials using a connection instead.
[2024-02-29T06:41:37.564+0000] {email.py:270} INFO - Email alerting: attempt 1
[2024-02-29T06:41:40.227+0000] {email.py:281} INFO - Sent an alert email to ['abhijit.bangal92@gmail.com']
[2024-02-29T06:41:42.017+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 100 for task blob_to_snowflake_stg (001003 (42000): 01b2ab51-0001-18d1-0000-000393fa7179: SQL compilation error:
syntax error line 1 at position 0 unexpected 'Truncat'.; 120)
[2024-02-29T06:41:42.060+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-02-29T06:41:42.079+0000] {logging_mixin.py:188} WARNING - /home/airflow/.local/lib/python3.11/site-packages/airflow/models/baseoperator.py:1201 AirflowProviderDeprecationWarning: Call to deprecated class SnowflakeOperator. (This class is deprecated. Please use `airflow.providers.common.sql.operators.sql.SQLExecuteQueryOperator`. Also, you can provide `hook_params={'warehouse': <warehouse>, 'database': <database>, 'role': <role>, 'schema': <schema>, 'authenticator': <authenticator>,'session_parameters': <session_parameters>}`.)
[2024-02-29T06:41:42.092+0000] {taskinstance.py:3309} INFO - 0 downstream tasks scheduled from follow-on schedule check
